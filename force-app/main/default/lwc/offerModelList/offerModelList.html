<!--
  @description       : 
  @author            : ChangeMeIn@UserSettingsUnder.SFDoc
  @group             : 
  @last modified on  : 03-15-2023
  @last modified by  : ChangeMeIn@UserSettingsUnder.SFDoc
-->
<template>
    <lightning-card >
      
      <!-- Add Model Button-->
      <lightning-layout multiple-rows >
        <lightning-layout-item size="12" flexibility="auto" padding="horizontal-small" class="slds-text-align_center">
            <!--<lightning-button label="Remove / Selected All" variant="brand" onclick={openNewRecord} style="margin-right: 10px;" class="slds-m-left_x-small">
            </lightning-button>-->
            
            <template if:true={showAddbtn}>
                <lightning-button size="medium" variant="brand" label="Add Model" style="margin-bottom:10px;" class="slds-align_absolute-center" onclick={addModel}>
                </lightning-button>
                
            </template>
        </lightning-layout-item>
    </lightning-layout>

    <!-- Warning and Error Messages -->
    <template if:true={ShowMgs}>
      <template if:true={showAddbtn}>
        <div  id="noprintSection" class="slds-scoped-notification slds-media slds-media_center slds-scoped-notification_light" role="status">
            <div class="slds-media__figure">
               <span class="slds-icon_container slds-icon-utility-info" title="info">
                  <lightning-icon icon-name="utility:info" alternative-text="Info" title="Info"></lightning-icon>
               </span>
            </div>
            <div class="slds-media__body">
               <p>Please use the "Add Model" button to add models to this offer.</p>
            </div>
         </div>
      </template>
    </template>
    <template if:true={ShowMgs}>
      <template if:false={showAddbtn}>
         <div class="slds-scoped-notification slds-media slds-media_center slds-theme_error" role="status">
            <div class="slds-media__figure">
              <span class="slds-icon_container slds-icon-utility-error" title="error">
                  <lightning-icon icon-name="utility:error" alternative-text="Error" title="Error" variant="inverse"></lightning-icon>
               </span>
            </div>
            <div class="slds-media__body">
               <p>This offer has no models associated with it. Please get in touch with your system administrator. </p>
            </div>
         </div>
      </template>
    </template>

    <!-- Display Model Table -->
   <template if:false={ShowMgs}>
      <template if:true={data}>
         <template if:true={isNOTPowerSports}>
            <template if:true={showAddbtn}>
               <template if:true={isLease}>
                  <lightning-datatable data={data} columns={columns} key-field="id" hide-checkbox-column="true"
                     onrowaction={handleRowActions} max-column-width="4000">
                  </lightning-datatable>
               </template>
               <template if:false={isLease}>
                  <lightning-datatable data={data} columns={columnsWithoutLease} key-field="id" hide-checkbox-column="true"
                     onrowaction={handleRowActions} max-column-width="4000">
                  </lightning-datatable>
               </template>
            </template>
         </template>
         <template if:true={isNOTPowerSports}>
            <template if:false={showAddbtn}>
               <template if:false={isPrism}>
                  <template if:true={isLease}>
                     <lightning-datatable data={data} columns={columnsWithNoActions} key-field="id"
                        hide-checkbox-column="true" onrowaction={handleRowActions} max-column-width="4000">
                     </lightning-datatable>
                  </template>
                  <template if:false={isLease}>
                     <lightning-datatable data={data} columns={columnsWithNoActionsWithoutLease} key-field="id"
                        hide-checkbox-column="true" onrowaction={handleRowActions} max-column-width="4000">
                     </lightning-datatable>
                  </template>
               </template>
         
         <template if:true={isPrism}>
            <template if:true={isLease}>
            <lightning-datatable data={data}
                                columns={columnsPrism}
                                key-field="id"
                                hide-checkbox-column="true"
                                onrowaction={handleRowActions}
                                max-column-width="4000">
            </lightning-datatable>
         </template>
         <template if:false={isLease}>
            <lightning-datatable data={data}
                                columns={columnsPrismWithoutLease}
                                key-field="id"
                                hide-checkbox-column="true"
                                onrowaction={handleRowActions}
                                max-column-width="4000">
            </lightning-datatable>
         </template>
         </template>
      </template>
         </template>
         <template if:false={isNOTPowerSports}>
            <template if:true={showAddbtn}>
            <lightning-datatable data={data}
                                columns={column}
                                key-field="id"
                                hide-checkbox-column="true"
                                onrowaction={handleRowActions}
                                max-column-width="4000">
            </lightning-datatable>
         </template>
         </template>
         <template if:false={isNOTPowerSports}>
            <template if:false={showAddbtn}>
               <template if:false={isPrism}>
            <lightning-datatable data={data}
                                columns={columnWithNoAction}
                                key-field="id"
                                hide-checkbox-column="true"
                                onrowaction={handleRowActions}
                                max-column-width="4000">
            </lightning-datatable>
         </template>
         <template if:true={isPrism}>
            <lightning-datatable data={data}
                                columns={columnPrism}
                                key-field="id"
                                hide-checkbox-column="true"
                                onrowaction={handleRowActions}
                                max-column-width="4000">
            </lightning-datatable>
         </template>
         </template>
         </template>
        </template>
    </template>

    <!-- Edit Model Modal Window-->
    <template if:true={showAddModelComponent}>
        <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
           <div class="slds-modal__container" style="width:100%;">
            <!-- modal header start --> 
              <header class="slds-modal__header">
                 <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick={handleCancel}>
                    <lightning-icon icon-name="utility:close"
                       alternative-text="close"
                       variant="inverse"
                       size="small" ></lightning-icon> 
                    <span class="slds-assistive-text">Close</span>
                 </button>
                 <h2 id="modal-heading-02" class="slds-text-heading_medium slds-hyphenate">Offer Eligible Model</h2>
              </header>
        
              <div class="slds-modal__content slds-grid" id="modal-content-id-2">
                <div style="margin:10px;width:100%">
                 <c-offer-model-details record-id={recordId} 
                 is-c-f-o={isNOTPowerSports}  has-model-id={OEMId} is-prism={isPrism} lease-identifier ={leaseIdentifier} onvalueselected={handleShowBack}></c-offer-model-details>
                </div> 
              </div>
             
              <!-- modal footer start -->
              <footer class="slds-modal__footer">
               <template if:true={showBack}>
               <button class="slds-button slds-button_neutral" onclick={handleBack}>Back</button>
            </template>
                 <lightning-button variant="destructive" label="Cancel" title="Destructive action" onclick={handleCancel} class="slds-m-left_x-small"></lightning-button>
                 <lightning-button variant="brand" label="Save" title="Primary action" onclick={handleSave} class="slds-m-left_x-small"></lightning-button>              </footer>
           
           </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
        <!--End of pop-up model-->
        </template>

        <!-- Delete Confirmation Popup -->
        <template if:true={showDelete}>
            <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open slds-modal_small">
               <div class="slds-modal__container" style="width: 50% !important;">
                <!-- modal header start --> 
                  <header class="slds-modal__header">
                     <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick={handleCancel}>
                        <lightning-icon icon-name="utility:close"
                           alternative-text="close"
                           variant="inverse"
                           size="small" ></lightning-icon> 
                        <span class="slds-assistive-text">Close</span>
                     </button>
                     <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate"> Delete Model</h2>
                  </header>
            
                  <div class="slds-modal__content" id="modal-content-id-1">
                    <div class="slds-align_absolute-center" style="margin-left: 20px;margin-bottom:15px;margin-top:15px;">
                        <h1> Are you sure you want to delete this model from the offer?</h1>
                    </div> 
                  </div>
                 
                  <!-- modal footer start -->
                  <footer class="slds-modal__footer">
                     <button class="slds-button slds-button_neutral" onclick={handleCancelDelete}>Cancel</button>
                     <button class="slds-button slds-button_destructive" onclick={handleDelete}>Delete</button>
                  </footer>
               
               </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
            <!--End of pop-up model-->

            </template>
            <template if:true={showSpinner}>
               <lightning-spinner alternative-text="Loading"></lightning-spinner>
           </template>
      
     </lightning-card>


</template>